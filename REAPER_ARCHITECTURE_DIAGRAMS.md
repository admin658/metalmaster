# System Architecture: MetalMaster â†’ MIDI â†’ Reaper

## High-Level Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MetalMaster Web App                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚        Tab Player Page (/tab-player)                â”‚       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚
â”‚  â”‚                                                      â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
â”‚  â”‚  â”‚  AlphaTabWrapper (alphaTab Player)          â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  - Loads Guitar Pro files (.gp3/.gp5/.gpx) â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  - Generates MIDI events                    â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  - Synthesizes audio (local soundfont)      â”‚   â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
â”‚  â”‚             â”‚                                       â”‚       â”‚
â”‚  â”‚             â”œâ”€â†’ midiEventsPlayed event             â”‚       â”‚
â”‚  â”‚             â”‚                                       â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚
â”‚  â”‚  â”‚  handleMidiEventsPlayed()                   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â”‚ For each MIDI event:                 â”‚   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â”‚ - Convert to raw MIDI bytes          â”‚   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â”‚ - Send via WebMIDI API               â”‚   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â”‚ - Track event (if monitor enabled)   â”‚   â”‚   â”‚       â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚       â”‚
â”‚  â”‚             â”‚                                       â”‚       â”‚
â”‚  â”‚             â”œâ”€â†’ TabPlayer Component UI            â”‚       â”‚
â”‚  â”‚             â”‚   â”œâ”€ Play/Pause/Stop buttons        â”‚       â”‚
â”‚  â”‚             â”‚   â”œâ”€ MIDI Output Selector â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”   â”‚
â”‚  â”‚             â”‚   â”œâ”€ Status Indicator (âœ“/âš ï¸/âœ—)      â”‚   â”‚   â”‚
â”‚  â”‚             â”‚   â””â”€ MIDI Monitor Panel             â”‚   â”‚   â”‚
â”‚  â”‚             â”‚       â”œâ”€ Event Counter              â”‚   â”‚   â”‚
â”‚  â”‚             â”‚       â””â”€ Last Event Display         â”‚   â”‚   â”‚
â”‚  â”‚             â”‚                                     â”‚   â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  MIDIOutput.send()                          â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [0x90|ch, note, vel] â†’ WebMIDI API        â”‚   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚                                                              â”‚   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”˜
                                                                â”‚
                           WebMIDI API
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Operating System       â”‚
                    â”‚   (Windows / macOS)      â”‚
                    â”‚   MIDI API               â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                      â”‚
      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  loopMIDI      â”‚                   â”‚  IAC Driver    â”‚
      â”‚  (Windows)     â”‚                   â”‚  (macOS)       â”‚
      â”‚  Virtual Port  â”‚                   â”‚  Virtual Bus   â”‚
      â”‚  1,2,3...      â”‚                   â”‚  1,2,3...      â”‚
      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                     â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    MIDI Stream (routed via
                    system audio/MIDI infrastructure)
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Reaper DAW        â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚ MIDI Input          â”‚
                    â”‚ â”œâ”€ Device: loopMIDI â”‚
                    â”‚ â”‚ Port: Port 1      â”‚
                    â”‚ â””â”€ Status: âœ“        â”‚
                    â”‚                     â”‚
                    â”‚ MIDI Track          â”‚
                    â”‚ â”œâ”€ Input: loopMIDI  â”‚
                    â”‚ â”‚        Port 1     â”‚
                    â”‚ â”‚                   â”‚
                    â”‚ â””â”€â†’ ReaGuitar â—„â”€â”€â”€â”€â”€â”¼â”€â”€â”€ MIDI Events
                    â”‚     Instrument      â”‚
                    â”‚     â”œâ”€ String 1     â”‚
                    â”‚     â”œâ”€ String 2     â”‚
                    â”‚     â””â”€ Effects:     â”‚
                    â”‚        â”œâ”€ Amp Sim   â”‚
                    â”‚        â”œâ”€ Reverb    â”‚
                    â”‚        â””â”€ Comp      â”‚
                    â”‚                     â”‚
                    â”‚ Master Track        â”‚
                    â”‚ â”œâ”€ Volume: 0 dB     â”‚
                    â”‚ â””â”€ Output: System   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    Audio Signal (with effects)
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Speakers /        â”‚
                    â”‚   Headphones        â”‚
                    â”‚                     â”‚
                    â”‚   ğŸ¸ Guitar Sound   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TabPlayer Component                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ State Management                                    â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ âœ“ api: AlphaTabApi                                â”‚     â”‚
â”‚  â”‚ âœ“ midiAccess: MIDIAccess                          â”‚     â”‚
â”‚  â”‚ âœ“ midiOutput: MIDIOutput (selected device)        â”‚     â”‚
â”‚  â”‚ âœ“ midiEventCount: number (monitor)                â”‚     â”‚
â”‚  â”‚ âœ“ midiMonitorEnabled: boolean (toggle)            â”‚     â”‚
â”‚  â”‚ âœ“ lastMidiEvent: string | null (last event log)   â”‚     â”‚
â”‚  â”‚ + other: isPlaying, tracks, playbackSpeed, etc.   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚           â”‚           â”‚           â”‚           â”‚             â”‚
â”‚           â–¼           â–¼           â–¼           â–¼             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Event Setup  â”‚ â”‚ MIDI Init    â”‚ â”‚ Render JSX      â”‚     â”‚
â”‚  â”‚              â”‚ â”‚              â”‚ â”‚                 â”‚     â”‚
â”‚  â”‚ .on()        â”‚ â”‚ request      â”‚ â”‚ - Controls Bar  â”‚     â”‚
â”‚  â”‚ handlers     â”‚ â”‚ MIDIAccess() â”‚ â”‚ - Monitor Panel â”‚     â”‚
â”‚  â”‚              â”‚ â”‚              â”‚ â”‚ - Status Ind.   â”‚     â”‚
â”‚  â”‚ playerReady  â”‚ â”‚ enumerate    â”‚ â”‚ - Output Sel.   â”‚     â”‚
â”‚  â”‚ scoreLoaded  â”‚ â”‚ outputs      â”‚ â”‚                 â”‚     â”‚
â”‚  â”‚ stateChanged â”‚ â”‚              â”‚ â”‚ Settings        â”‚     â”‚
â”‚  â”‚ midiEvents   â”‚ â”‚ setDefaultOutâ”‚ â”‚                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚              â”‚ â”‚ Display Opts    â”‚     â”‚
â”‚  Triggered By:    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  - Page mount                                                â”‚
â”‚  - Tab load                                                  â”‚
â”‚  - Play action                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ midiEventsPlayed     â”‚
                 â”‚ Callback Handler     â”‚
                 â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                 â”‚                      â”‚
                 â”‚ Receives event batch â”‚
                 â”‚ from alphaTab        â”‚
                 â”‚                      â”‚
                 â”‚ For each event:      â”‚
                 â”‚ 1. Check output      â”‚
                 â”‚ 2. Convert to bytes  â”‚
                 â”‚ 3. Send via WebMIDI  â”‚
                 â”‚ 4. Log (if monitor)  â”‚
                 â”‚                      â”‚
                 â”‚ Updates:             â”‚
                 â”‚ - midiEventCount     â”‚
                 â”‚ - lastMidiEvent      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ MIDIOutput.send()       â”‚
                 â”‚ [status, data1, data2]  â”‚
                 â”‚                         â”‚
                 â”‚ Examples:               â”‚
                 â”‚ [0x90, 60, 100]  Note Onâ”‚
                 â”‚ [0x80, 60, 0]    Note Off
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                         WebMIDI
                        â†“â†“â†“â†“â†“â†“â†“
                    (Reaper receives)
```

## MIDI Message Format

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        MIDI Note On Message         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Byte 1: Status + Channel            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 1001 | Channel (4-bit)         â”‚  â”‚
â”‚ â”‚ 0x90 = Channel 0               â”‚  â”‚
â”‚ â”‚ 0x91 = Channel 1               â”‚  â”‚
â”‚ â”‚ ... up to 0x9F = Channel 15    â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Byte 2: Note Number (Key)           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 0-127 (Middle C = 60)          â”‚  â”‚
â”‚ â”‚ C0 = 12, C1 = 24, C2 = 36...   â”‚  â”‚
â”‚ â”‚ C4 (Middle) = 60               â”‚  â”‚
â”‚ â”‚ C8 = 108                       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Byte 3: Velocity (Loudness)         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 0-127 (0 = silence, 127 = max)â”‚  â”‚
â”‚ â”‚ alphaTab uses 1-127            â”‚  â”‚
â”‚ â”‚ Reaper/ReaGuitar responds to   â”‚  â”‚
â”‚ â”‚ exact velocities sent          â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Example:                             â”‚
â”‚ [0x90, 60, 100] = Note On,          â”‚
â”‚ Channel 0, Middle C, Velocity 100   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       MIDI Note Off Message         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Byte 1: Status + Channel            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ 1000 | Channel (4-bit)         â”‚  â”‚
â”‚ â”‚ 0x80 = Channel 0               â”‚  â”‚
â”‚ â”‚ 0x81 = Channel 1 ... 0x8F      â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Byte 2: Note Number (Key)           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Same as Note On (must match)   â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Byte 3: Release Velocity            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Usually 0 (instant release)    â”‚  â”‚
â”‚ â”‚ alphaTab uses 0                â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Example:                             â”‚
â”‚ [0x80, 60, 0] = Note Off,           â”‚
â”‚ Channel 0, Middle C, Release 0      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Browser â†’ OS â†’ DAW Flow

```
BROWSER (MetalMaster)
â”‚
â”œâ”€ WebMIDI API (navigator.requestMIDIAccess)
â”‚  â””â”€ Lists available MIDI outputs from OS
â”‚
â”œâ”€ MIDIOutput.send([status, key, velocity])
â”‚  â””â”€ Sends bytes to OS MIDI API
â”‚
OPERATING SYSTEM (Windows 10/11, macOS, Linux)
â”‚
â”œâ”€ MIDI Subsystem
â”‚  â”œâ”€ loopMIDI (Windows virtual cable)
â”‚  â”œâ”€ IAC Driver (macOS virtual bus)
â”‚  â””â”€ ALSA/Jack (Linux)
â”‚
â”œâ”€ Routes MIDI stream from source â†’ destination
â”‚
DESTINATION APPLICATION (Reaper)
â”‚
â”œâ”€ MIDI Input Device (loopMIDI Port 1 / IAC Bus 1)
â”‚  â””â”€ Receives byte stream from MetalMaster
â”‚
â”œâ”€ MIDI Track
â”‚  â”œâ”€ Input routing: loopMIDI Port 1
â”‚  â””â”€ Events processed for timing/quantization
â”‚
â”œâ”€ Virtual Instrument (ReaGuitar)
â”‚  â”œâ”€ Receives MIDI Note On â†’ plays sound
â”‚  â””â”€ Receives MIDI Note Off â†’ stops sound
â”‚
â”œâ”€ Effects Chain
â”‚  â”œâ”€ Amp simulator (distortion, cabinet)
â”‚  â”œâ”€ Reverb (space)
â”‚  â”œâ”€ Compression (dynamics)
â”‚  â””â”€ EQ (tone shaping)
â”‚
â”œâ”€ Audio Output
â”‚  â””â”€ Master fader â†’ System audio device
â”‚
AUDIO HARDWARE (Speakers / Headphones)
â”‚
â””â”€ ğŸµ Guitar sound!
```

## State Transitions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component Init  â”‚
â”‚  â”œâ”€ Load state   â”‚
â”‚  â””â”€ Setup events â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Request MIDI    â”‚
â”‚  Access from OS  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ Permission granted
         â”‚  â””â”€ setMidiAccess(access)
         â”‚     Enumerate outputs
         â”‚
         â”œâ”€ Set default output
         â”‚  â””â”€ setMidiOutput(first)
         â”‚
         â””â”€ Permission denied
            â””â”€ Continue without MIDI
               (graceful fallback)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Tab File   â”‚
â”‚  (alphaTab API)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Player Ready    â”‚
â”‚  scoreLoaded     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Clicks     â”‚
â”‚  Play Button     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  alphaTab        â”‚
â”‚  Generates MIDI  â”‚
â”‚  Events          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ midiEventsPlayed
         â”‚  â”œâ”€ handleMidiEventsPlayed()
         â”‚  â”‚  â”œâ”€ Check midiOutput
         â”‚  â”‚  â”œâ”€ Convert to bytes
         â”‚  â”‚  â”œâ”€ .send() to WebMIDI
         â”‚  â”‚  â””â”€ Log event (monitor)
         â”‚  â”‚
         â”‚  â””â”€ Update UI state
         â”‚     â”œâ”€ midiEventCount++
         â”‚     â””â”€ lastMidiEvent = "..."
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Monitor Updates â”‚
â”‚  â”œâ”€ Display countâ”‚
â”‚  â””â”€ Show event   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    [Loop while playing]
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Clicks     â”‚
â”‚  Stop Button     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reset Monitor   â”‚
â”‚  â”œâ”€ Count = 0    â”‚
â”‚  â””â”€ Event = null â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ready for Next  â”‚
â”‚  Tab / Playback  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Diagram Created:** December 2025  
**Status:** Complete
